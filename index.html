<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8">
  <title>RVC101 Photo Booth v12 ‚Äî Multi-Frame Edition</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
  <style>
    :root{
      --bg1:#0b0f1a; --bg2:#1a1a2e; --purple:#7b3fe4; --blue:#00d4ff;
      --pink:#ff0080; --gold:#ffd700; --green:#00ff88; --text:#e9f0ff;
    }
    *{box-sizing:border-box}
    body{
      margin:0; font-family:system-ui,Segoe UI,Roboto,Arial; color:var(--text);
      background:linear-gradient(135deg,var(--bg1),var(--bg2));
    }
    .container{max-width:1100px;margin:auto;padding:20px}
    header{text-align:center;margin:10px 0 20px}
    h1{
      font-size:2rem;margin:0;background:linear-gradient(45deg,var(--blue),var(--purple),var(--pink));
      -webkit-background-clip:text;-webkit-text-fill-color:transparent;
    }
    .badge{
      background:linear-gradient(45deg,var(--gold),#ff9933);color:#000;padding:3px 10px;border-radius:12px;
      font-weight:700;margin-left:6px;
    }
    .grid{display:grid;gap:20px;grid-template-columns:1.2fr .8fr}
    @media(max-width:900px){.grid{grid-template-columns:1fr}}
    .panel{background:rgba(0,0,0,.55);border:1px solid rgba(123,63,228,.35);
      border-radius:14px;padding:16px;box-shadow:0 0 25px rgba(123,63,228,.18)}
    .camera{position:relative;border-radius:14px;overflow:hidden;background:#000}
    video{display:block;width:100%;height:auto}
    .placeholder{aspect-ratio:16/9;display:flex;align-items:center;justify-content:center;flex-direction:column;
      color:#bcd;border:2px dashed rgba(123,63,228,.3)}
    .frame-overlay{
      position:absolute;inset:0;pointer-events:none;opacity:.9;display:none;
    }
    .frame-overlay.active{display:block}
    .btns{display:flex;flex-wrap:wrap;gap:10px;justify-content:center;margin-top:10px}
    .btn{border:0;padding:12px 18px;border-radius:10px;font-weight:700;color:#fff;
      background:linear-gradient(45deg,var(--purple),var(--blue));cursor:pointer}
    .btn.warn{background:linear-gradient(45deg,var(--gold),#ff9933);color:#000}
    .btn.alt{background:linear-gradient(45deg,#444,#777)}
    .controls label{font-weight:700;color:var(--blue);display:block;margin:8px 0 4px}
    input[type="text"],select,input[type="file"]{
      width:100%;padding:10px;border-radius:10px;border:1px solid rgba(123,63,228,.3);
      background:rgba(255,255,255,.05);color:var(--text)
    }
    input[type="range"]{width:100%}
    .frames{display:grid;grid-template-columns:repeat(2,1fr);gap:8px;margin-top:8px}
    .frame-btn{
      border:2px solid rgba(123,63,228,.3);border-radius:8px;padding:8px;text-align:center;
      background:rgba(255,255,255,.05);cursor:pointer;font-size:.9rem;font-weight:600;
    }
    .frame-btn.active,.frame-btn:hover{
      border-color:var(--blue);background:rgba(0,212,255,.1)
    }
    .preview img{max-width:100%;border-radius:12px;box-shadow:0 0 25px rgba(123,63,228,.3)}
    .qr{text-align:center;margin-top:10px}
    footer{text-align:center;margin:20px 0;color:#cce}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>RVC101 Photo Booth <span class="badge">v12 Multi-Frame</span></h1>
      <p>üì∏ ‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á ‚Ä¢ ‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏á ‚Ä¢ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏£‡∏≠‡∏ö ‚Ä¢ ‡∏ñ‡πà‡∏≤‡∏¢‡∏†‡∏≤‡∏û ‚Ä¢ ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î/QR</p>
    </header>

    <div class="grid">
      <!-- CAMERA -->
      <section class="panel">
        <div class="camera" id="camBox">
          <video id="video" autoplay playsinline muted style="display:none;"></video>
          <div class="placeholder" id="ph">
            <p>‡∏Å‡∏î ‚Äú‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á‚Äù ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°</p>
            <small>‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏Å‡∏•‡πâ‡∏≠‡∏á / ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏ú‡πà‡∏≤‡∏ô HTTPS</small>
          </div>
          <!-- dynamic overlays -->
          <img id="overlayImg" class="frame-overlay" alt="">
        </div>

        <div class="btns">
          <button class="btn" id="start">üì∑ ‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á</button>
          <button class="btn alt" id="rotate">‚Üª ‡∏´‡∏°‡∏∏‡∏ô 90¬∞</button>
          <button class="btn warn" id="capture">üì∏ ‡∏ñ‡πà‡∏≤‡∏¢‡∏†‡∏≤‡∏û</button>
          <button class="btn alt" id="timer">‚è∞ ‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏ß‡∏•‡∏≤</button>
        </div>

        <div class="btns" id="timerRow" style="display:none;">
          <button class="btn alt" data-t="3">3 ‡∏ß‡∏¥</button>
          <button class="btn alt" data-t="5">5 ‡∏ß‡∏¥</button>
          <button class="btn alt" data-t="10">10 ‡∏ß‡∏¥</button>
          <button class="btn" id="cancelT">‚ùå ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
        </div>

        <div class="panel preview" id="preview" style="display:none;margin-top:10px;">
          <div style="text-align:center;font-weight:700;margin-bottom:8px">‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà‡∏ñ‡πà‡∏≤‡∏¢</div>
          <img id="prevImg" alt="preview">
          <div class="btns">
            <button class="btn" id="dl">üíæ ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î</button>
            <button class="btn alt" id="qr">üì± QR Code</button>
          </div>
          <div class="qr" id="qrBox" style="display:none;">
            <canvas id="qrCanvas"></canvas>
            <p style="font-size:.8rem;color:#ccc">‡∏™‡πÅ‡∏Å‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡∏†‡∏≤‡∏û</p>
          </div>
        </div>
      </section>

      <!-- CONTROLS -->
      <aside class="panel controls">
        <label>‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô</label><input id="nick" type="text" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡πÇ‡∏ü‡∏Å‡∏±‡∏™">
        <label>‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡∏°</label><input id="team" type="text" placeholder="‡πÄ‡∏ä‡πà‡∏ô Team Hero">

        <label>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏ß‡πà‡∏≤‡∏á <span id="bVal">100%</span></label>
        <input id="bright" type="range" min="50" max="150" value="100">
        <label>‡∏Ñ‡∏≠‡∏ô‡∏ó‡∏£‡∏≤‡∏™‡∏ï‡πå <span id="cVal">100%</span></label>
        <input id="cont" type="range" min="50" max="150" value="100">

        <label>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏£‡∏≠‡∏ö‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</label>
        <div class="frames" id="frameBtns">
          <div class="frame-btn active" data-frame="main">RVC101 Main</div>
          <div class="frame-btn" data-frame="champ">Champion</div>
          <div class="frame-btn" data-frame="hero">Team Hero</div>
          <div class="frame-btn" data-frame="neon">Neon</div>
          <div class="frame-btn" data-frame="glitch">Glitch</div>
        </div>

        <label style="margin-top:10px;">‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏Å‡∏£‡∏≠‡∏ö‡πÄ‡∏≠‡∏á (PNG/JPG ‡πÑ‡∏î‡πâ‡∏´‡∏•‡∏≤‡∏¢‡πÑ‡∏ü‡∏•‡πå)</label>
        <input id="upload" type="file" accept="image/*" multiple>

        <label style="margin-top:10px;">‡∏Ç‡∏ô‡∏≤‡∏î‡∏†‡∏≤‡∏û‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å</label>
        <select id="size">
          <option value="hd">HD (1280x720)</option>
          <option value="fullhd" selected>Full HD (1920x1080)</option>
        </select>
      </aside>
    </div>

    <footer>
      ‡∏à‡∏±‡∏î‡∏ó‡∏≥‡πÇ‡∏î‡∏¢ ‡∏Ñ‡∏£‡∏π‡∏™‡∏∏‡∏†‡∏≤‡∏î‡∏≤ ‡∏Ñ‡∏≥‡∏ï‡∏≤ | ‡πÅ‡∏ú‡∏ô‡∏Å‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡∏™‡∏≤‡∏£‡∏™‡∏ô‡πÄ‡∏ó‡∏® ‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡∏≠‡∏≤‡∏ä‡∏µ‡∏ß‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏£‡πâ‡∏≠‡∏¢‡πÄ‡∏≠‡πá‡∏î
    </footer>
  </div>

  <canvas id="work" style="display:none"></canvas>

  <script>
  let stream=null,rotation=0,currentFrame='main',customFrames=[];
  const v=document.getElementById('video'),ph=document.getElementById('ph');
  const start=document.getElementById('start'),rotate=document.getElementById('rotate');
  const capture=document.getElementById('capture'),timer=document.getElementById('timer');
  const timerRow=document.getElementById('timerRow'),cancelT=document.getElementById('cancelT');
  const bright=document.getElementById('bright'),cont=document.getElementById('cont');
  const bVal=document.getElementById('bVal'),cVal=document.getElementById('cVal');
  const overlay=document.getElementById('overlayImg');
  const frameBtns=document.getElementById('frameBtns');
  const upload=document.getElementById('upload');
  const nick=document.getElementById('nick'),team=document.getElementById('team');
  const work=document.getElementById('work'),ctx=work.getContext('2d');
  const preview=document.getElementById('preview'),prevImg=document.getElementById('prevImg');
  const dl=document.getElementById('dl'),qr=document.getElementById('qr'),qrBox=document.getElementById('qrBox'),qrCanvas=document.getElementById('qrCanvas');
  const sizeSel=document.getElementById('size');

  bright.oninput=()=>{bVal.textContent=bright.value+'%';applyFilter();}
  cont.oninput=()=>{cVal.textContent=cont.value+'%';applyFilter();}

  frameBtns.onclick=e=>{
    const el=e.target.closest('.frame-btn');if(!el)return;
    frameBtns.querySelectorAll('.frame-btn').forEach(b=>b.classList.remove('active'));
    el.classList.add('active');currentFrame=el.dataset.frame;
    updateOverlay();
  }

  upload.onchange=e=>{
    const files=[...e.target.files];
    files.forEach((f,i)=>{
      const reader=new FileReader();
      reader.onload=ev=>{
        const img=new Image();
        img.onload=()=>{
          customFrames.push({name:f.name,image:img});
          addCustomButton(f.name,customFrames.length-1);
        }
        img.src=ev.target.result;
      }
      reader.readAsDataURL(f);
    });
  }

  function addCustomButton(name,idx){
    const btn=document.createElement('div');
    btn.className='frame-btn';
    btn.textContent='üñº '+name.split('.')[0];
    btn.dataset.frame='custom'+idx;
    btn.onclick=()=>{
      frameBtns.querySelectorAll('.frame-btn').forEach(b=>b.classList.remove('active'));
      btn.classList.add('active');
      currentFrame='custom'+idx;
      updateOverlay();
    }
    frameBtns.appendChild(btn);
  }

  start.onclick=async()=>{
    try{
      stream=await navigator.mediaDevices.getUserMedia({video:true});
      v.srcObject=stream;await v.play();
      v.style.display='block';ph.style.display='none';
      [rotate,capture,timer].forEach(b=>b.disabled=false);
      applyFilter();
    }catch(e){alert('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á‡πÑ‡∏î‡πâ');}
  }

  rotate.onclick=()=>{rotation=(rotation+90)%360;applyFilter();}
  function applyFilter(){v.style.filter=`brightness(${bright.value}%) contrast(${cont.value}%)`;v.style.transform=`rotate(${rotation}deg)`;}

  capture.onclick=capturePhoto;
  timer.onclick=()=>timerRow.style.display='flex';
  timerRow.onclick=e=>{
    const t=e.target.dataset.t;if(!t)return;
    timerRow.style.display='none';let sec=parseInt(t);const id=setInterval(()=>{
      if(sec<=0){clearInterval(id);capturePhoto();}
      else{capture.textContent='‚è∞ '+sec+' ‡∏ß‡∏¥';sec--;}
    },1000);
  }
  cancelT.onclick=()=>timerRow.style.display='none';

  function capturePhoto(){
    if(!nick.value.trim()||!team.value.trim()){alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏•‡∏∞‡∏ó‡∏µ‡∏°');return;}
    const s=sizeSel.value;let w=1920,h=1080;if(s==='hd'){w=1280;h=720;}
    work.width=w;work.height=h;ctx.save();
    if(rotation){ctx.translate(w/2,h/2);ctx.rotate(rotation*Math.PI/180);ctx.translate(-w/2,-h/2);}
    ctx.filter=`brightness(${bright.value}%) contrast(${cont.value}%)`;
    ctx.drawImage(v,0,0,w,h);ctx.filter='none';
    drawFrame(ctx,w,h);drawText(ctx,w,h);
    ctx.restore();
    const data=work.toDataURL('image/png');
    prevImg.src=data;preview.style.display='block';qrBox.style.display='none';
    currentData=data;flash();
  }

  function drawFrame(c,w,h){
    c.save();
    const id=currentFrame;
    if(id.startsWith('custom')){
      const idx=parseInt(id.replace('custom',''));
      const img=customFrames[idx]?.image;
      if(img)c.drawImage(img,0,0,w,h);
    }else{
      c.strokeStyle='#7b3fe4';c.lineWidth=10;c.strokeRect(10,10,w-20,h-20);
    }
    c.restore();
  }

  function drawText(c,w,h){
    c.fillStyle='rgba(0,0,0,.6)';c.fillRect(0,h-100,w,100);
    c.fillStyle='#00d4ff';c.font='bold 30px Arial';c.fillText('üéÆ '+nick.value,30,h-60);
    c.fillStyle='#7b3fe4';c.font='bold 26px Arial';c.fillText('üèÜ '+team.value,30,h-25);
  }

  let currentData=null;
  dl.onclick=()=>{if(!currentData)return;const a=document.createElement('a');a.href=currentData;a.download='RVC101.png';a.click();}
  qr.onclick=async()=>{
    if(!currentData)return;
    const html='data:text/html;charset=utf-8,'+encodeURIComponent(`<html><body style="margin:0;text-align:center;background:#111;color:#fff"><img src="${currentData}" style="max-width:90%"><script>var a=document.createElement('a');a.href='${currentData}';a.download='RVC101.png';a.click();<\/script></body></html>`);
    await QRCode.toCanvas(qrCanvas,html,{width:220});
    qrBox.style.display='block';
  }

  function updateOverlay(){
    overlay.style.display='none';
    if(currentFrame.startsWith('custom')){
      const idx=parseInt(currentFrame.replace('custom',''));
      const img=customFrames[idx]?.image;
      if(img){overlay.src=img.src;overlay.style.display='block';}
    }else{overlay.src='';}
  }

  function flash(){
    const f=document.createElement('div');
    f.style.cssText='position:fixed;inset:0;background:#fff;opacity:.8;z-index:9999';
    document.body.appendChild(f);
    setTimeout(()=>{f.style.transition='opacity .3s';f.style.opacity='0';setTimeout(()=>f.remove(),300);},120);
  }
  </script>
</body>
</html>
