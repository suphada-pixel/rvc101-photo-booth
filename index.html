<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8">
  <title>RVC101 Photo Booth v12 ‚Äî Multi-Frame + Delete All Edition</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
  <style>
    :root{
      --bg1:#0b0f1a;--bg2:#1a1a2e;--purple:#7b3fe4;--blue:#00d4ff;
      --pink:#ff0080;--gold:#ffd700;--green:#00ff88;--text:#e9f0ff;
    }
    *{box-sizing:border-box}
    body{
      margin:0;font-family:system-ui,Segoe UI,Roboto,Arial;color:var(--text);
      background:linear-gradient(135deg,var(--bg1),var(--bg2));
    }
    .container{max-width:1100px;margin:auto;padding:20px}
    header{text-align:center;margin:10px 0 20px}
    h1{font-size:2rem;margin:0;background:linear-gradient(45deg,var(--blue),var(--purple),var(--pink));
      -webkit-background-clip:text;-webkit-text-fill-color:transparent;}
    .badge{background:linear-gradient(45deg,var(--gold),#ff9933);color:#000;
      padding:3px 10px;border-radius:12px;font-weight:700;margin-left:6px}
    .grid{display:grid;gap:20px;grid-template-columns:1.2fr .8fr}
    @media(max-width:900px){.grid{grid-template-columns:1fr}}
    .panel{background:rgba(0,0,0,.55);border:1px solid rgba(123,63,228,.35);
      border-radius:14px;padding:16px;box-shadow:0 0 25px rgba(123,63,228,.18)}
    .camera{position:relative;border-radius:14px;overflow:hidden;background:#000}
    video{display:block;width:100%;height:auto}
    .placeholder{aspect-ratio:16/9;display:flex;align-items:center;justify-content:center;
      flex-direction:column;color:#bcd;border:2px dashed rgba(123,63,228,.3)}
    .frame-overlay{position:absolute;inset:0;pointer-events:none;opacity:.9;display:none}
    .frame-overlay.active{display:block}
    .btns{display:flex;flex-wrap:wrap;gap:10px;justify-content:center;margin-top:10px}
    .btn{border:0;padding:12px 18px;border-radius:10px;font-weight:700;color:#fff;
      background:linear-gradient(45deg,var(--purple),var(--blue));cursor:pointer}
    .btn.warn{background:linear-gradient(45deg,var(--gold),#ff9933);color:#000}
    .btn.alt{background:linear-gradient(45deg,#444,#777)}
    .controls label{font-weight:700;color:var(--blue);display:block;margin:8px 0 4px}
    input[type="text"],select,input[type="file"]{
      width:100%;padding:10px;border-radius:10px;border:1px solid rgba(123,63,228,.3);
      background:rgba(255,255,255,.05);color:var(--text)
    }
    input[type="range"]{width:100%}
    .frames{display:grid;grid-template-columns:repeat(2,1fr);gap:8px;margin-top:8px}
    .frame-btn{
      border:2px solid rgba(123,63,228,.3);border-radius:8px;padding:8px;text-align:center;
      background:rgba(255,255,255,.05);cursor:pointer;font-size:.9rem;font-weight:600;
      position:relative;overflow:hidden;
    }
    .frame-btn.active,.frame-btn:hover{
      border-color:var(--blue);background:rgba(0,212,255,.1)
    }
    .del-frame{
      position:absolute;top:3px;right:5px;background:#ff4444;color:#fff;
      border:none;border-radius:50%;width:20px;height:20px;font-size:.8rem;
      cursor:pointer;display:none;
    }
    .frame-btn.custom:hover .del-frame{display:block}
    .preview img{max-width:100%;border-radius:12px;box-shadow:0 0 25px rgba(123,63,228,.3)}
    .qr{text-align:center;margin-top:10px}
    footer{text-align:center;margin:20px 0;color:#cce}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>RVC101 Photo Booth <span class="badge">v12 Multi-Frame + Delete All</span></h1>
      <p>üì∏ ‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á ‚Ä¢ ‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏á ‚Ä¢ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏£‡∏≠‡∏ö ‚Ä¢ ‡∏ñ‡πà‡∏≤‡∏¢‡∏†‡∏≤‡∏û ‚Ä¢ ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î/QR</p>
    </header>

    <div class="grid">
      <!-- CAMERA -->
      <section class="panel">
        <div class="camera">
          <video id="video" autoplay playsinline muted style="display:none;"></video>
          <div class="placeholder" id="ph">
            <p>‡∏Å‡∏î ‚Äú‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á‚Äù ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°</p>
            <small>‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏Å‡∏•‡πâ‡∏≠‡∏á / ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏ú‡πà‡∏≤‡∏ô HTTPS</small>
          </div>
          <img id="overlay" class="frame-overlay" alt="">
        </div>

        <div class="btns">
          <button class="btn" id="start">üì∑ ‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á</button>
          <button class="btn alt" id="rotate">‚Üª ‡∏´‡∏°‡∏∏‡∏ô 90¬∞</button>
          <button class="btn warn" id="capture">üì∏ ‡∏ñ‡πà‡∏≤‡∏¢‡∏†‡∏≤‡∏û</button>
        </div>

        <div class="panel preview" id="preview" style="display:none;margin-top:10px;">
          <div style="text-align:center;font-weight:700;margin-bottom:8px">‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà‡∏ñ‡πà‡∏≤‡∏¢</div>
          <img id="prevImg">
          <div class="btns">
            <button class="btn" id="dl">üíæ ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î</button>
            <button class="btn alt" id="qr">üì± QR Code</button>
          </div>
          <div class="qr" id="qrBox" style="display:none;">
            <canvas id="qrCanvas"></canvas>
            <p style="font-size:.8rem;color:#ccc">‡∏™‡πÅ‡∏Å‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡∏†‡∏≤‡∏û</p>
          </div>
        </div>
      </section>

      <!-- CONTROLS -->
      <aside class="panel controls">
        <label>‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô</label><input id="nick" type="text">
        <label>‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡∏°</label><input id="team" type="text">
        <label>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏ß‡πà‡∏≤‡∏á <span id="bVal">100%</span></label><input id="bright" type="range" min="50" max="150" value="100">
        <label>‡∏Ñ‡∏≠‡∏ô‡∏ó‡∏£‡∏≤‡∏™‡∏ï‡πå <span id="cVal">100%</span></label><input id="cont" type="range" min="50" max="150" value="100">
        
        <label>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏£‡∏≠‡∏ö</label>
        <div class="frames" id="frameBtns">
          <div class="frame-btn active" data-frame="main">RVC101 Main</div>
          <div class="frame-btn" data-frame="champ">Champion</div>
          <div class="frame-btn" data-frame="hero">Team Hero</div>
          <div class="frame-btn" data-frame="neon">Neon</div>
        </div>

        <label style="margin-top:10px;">‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏Å‡∏£‡∏≠‡∏ö‡πÄ‡∏≠‡∏á (‡∏´‡∏•‡∏≤‡∏¢‡πÑ‡∏ü‡∏•‡πå)</label>
        <input id="upload" type="file" accept="image/*" multiple>
        <div class="btns"><button class="btn alt" id="clearAll">üóëÔ∏è ‡∏•‡∏ö‡∏Å‡∏£‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button></div>
      </aside>
    </div>

    <footer>‡∏à‡∏±‡∏î‡∏ó‡∏≥‡πÇ‡∏î‡∏¢ ‡∏Ñ‡∏£‡∏π‡∏™‡∏∏‡∏†‡∏≤‡∏î‡∏≤ ‡∏Ñ‡∏≥‡∏ï‡∏≤ | ‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡∏≠‡∏≤‡∏ä‡∏µ‡∏ß‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏£‡πâ‡∏≠‡∏¢‡πÄ‡∏≠‡πá‡∏î</footer>
  </div>

  <canvas id="work" style="display:none"></canvas>

<script>
let stream=null,rotation=0,currentFrame='main',customFrames=[];
const $=s=>document.querySelector(s);
const v=$('#video'),ph=$('#ph'),overlay=$('#overlay');
const start=$('#start'),rotateBtn=$('#rotate'),capture=$('#capture');
const bright=$('#bright'),cont=$('#cont'),bVal=$('#bVal'),cVal=$('#cVal');
const frameBtns=$('#frameBtns'),upload=$('#upload'),clearAll=$('#clearAll');
const nick=$('#nick'),team=$('#team');
const work=$('#work'),ctx=work.getContext('2d');
const preview=$('#preview'),prevImg=$('#prevImg');
const dl=$('#dl'),qr=$('#qr'),qrBox=$('#qrBox'),qrCanvas=$('#qrCanvas');

bright.oninput=()=>{bVal.textContent=bright.value+'%';applyFilter();}
cont.oninput=()=>{cVal.textContent=cont.value+'%';applyFilter();}
function applyFilter(){v.style.filter=`brightness(${bright.value}%) contrast(${cont.value}%) rotate(${rotation}deg)`;}

frameBtns.addEventListener('click',e=>{
  const el=e.target.closest('.frame-btn');
  if(!el||el.classList.contains('del-frame'))return;
  frameBtns.querySelectorAll('.frame-btn').forEach(b=>b.classList.remove('active'));
  el.classList.add('active');
  currentFrame=el.dataset.frame;
  updateOverlay();
});

upload.onchange=e=>{
  [...e.target.files].forEach((f,i)=>{
    const reader=new FileReader();
    reader.onload=ev=>{
      const img=new Image();
      img.onload=()=>{
        customFrames.push({name:f.name,image:img});
        addFrameButton(f.name,customFrames.length-1);
      };
      img.src=ev.target.result;
    };
    reader.readAsDataURL(f);
  });
};

clearAll.onclick=()=>{
  customFrames=[];
  [...frameBtns.querySelectorAll('.custom')].forEach(e=>e.remove());
  overlay.style.display='none';
};

function addFrameButton(name,idx){
  const btn=document.createElement('div');
  btn.className='frame-btn custom';
  btn.dataset.frame='custom'+idx;
  btn.innerHTML='üñº '+name.split('.')[0]+' <button class="del-frame" title="‡∏•‡∏ö">√ó</button>';
  btn.querySelector('.del-frame').onclick=(ev)=>{
    ev.stopPropagation();
    customFrames[idx]=null;
    btn.remove();
    overlay.style.display='none';
  };
  btn.onclick=()=>{
    frameBtns.querySelectorAll('.frame-btn').forEach(b=>b.classList.remove('active'));
    btn.classList.add('active');
    currentFrame='custom'+idx;
    updateOverlay();
  };
  frameBtns.appendChild(btn);
}

start.onclick=async()=>{
  try{
    stream=await navigator.mediaDevices.getUserMedia({video:true});
    v.srcObject=stream;await v.play();
    v.style.display='block';ph.style.display='none';
    applyFilter();
  }catch(e){alert('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á‡πÑ‡∏î‡πâ');}
};
rotateBtn.onclick=()=>{rotation=(rotation+90)%360;applyFilter();};

capture.onclick=()=>{
  if(!nick.value.trim()||!team.value.trim()){alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏•‡∏∞‡∏ó‡∏µ‡∏°');return;}
  work.width=1920;work.height=1080;ctx.save();
  if(rotation){ctx.translate(960,540);ctx.rotate(rotation*Math.PI/180);ctx.translate(-960,-540);}
  ctx.filter=`brightness(${bright.value}%) contrast(${cont.value}%)`;
  ctx.drawImage(v,0,0,1920,1080);ctx.filter='none';
  drawFrame(ctx,1920,1080);drawText(ctx,1920,1080);
  ctx.restore();
  const data=work.toDataURL('image/png');
  prevImg.src=data;preview.style.display='block';qrBox.style.display='none';
  currentData=data;flash();
};

function drawFrame(c,w,h){
  c.save();
  if(currentFrame.startsWith('custom')){
    const idx=parseInt(currentFrame.replace('custom',''));
    const f=customFrames[idx];
    if(f&&f.image)c.drawImage(f.image,0,0,w,h);
  }else{
    c.strokeStyle='#7b3fe4';c.lineWidth=10;c.strokeRect(10,10,w-20,h-20);
  }
  c.restore();
}
function drawText(c,w,h){
  c.fillStyle='rgba(0,0,0,.6)';c.fillRect(0,h-100,w,100);
  c.fillStyle='#00d4ff';c.font='bold 32px Arial';c.fillText('üéÆ '+nick.value,30,h-60);
  c.fillStyle='#7b3fe4';c.font='bold 28px Arial';c.fillText('üèÜ '+team.value,30,h-25);
}
let currentData=null;
dl.onclick=()=>{if(!currentData)return;const a=document.createElement('a');a.href=currentData;a.download='RVC101.png';a.click();};
qr.onclick=async()=>{
  if(!currentData)return;
  const html='data:text/html;charset=utf-8,'+encodeURIComponent(`<html><body style="margin:0;text-align:center;background:#111;color:#fff"><img src="${currentData}" style="max-width:90%"><script>var a=document.createElement('a');a.href='${currentData}';a.download='RVC101.png';a.click();<\/script></body></html>`);
  await QRCode.toCanvas(qrCanvas,html,{width:220});qrBox.style.display='block';
};

function updateOverlay(){
  overlay.style.display='none';
  if(currentFrame.startsWith('custom')){
    const idx=parseInt(currentFrame.replace('custom',''));
    const f=customFrames[idx];
    if(f&&f.image){overlay.src=f.image.src;overlay.style.display='block';}
  }
}
function flash(){
  const f=document.createElement('div');
  f.style.cssText='position:fixed;inset:0;background:#fff;opacity:.8;z-index:9999';
  document.body.appendChild(f);
  setTimeout(()=>{f.style.transition='opacity .3s';f.style.opacity='0';setTimeout(()=>f.remove(),300);},100);
}
</script>
</body>
</html>
