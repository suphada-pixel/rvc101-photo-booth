<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RVC Smart Career Photo Booth</title>
    <!-- ‡πÇ‡∏´‡∏•‡∏î Tailwind CSS CDN ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏ó‡∏µ‡πà‡∏™‡∏ß‡∏¢‡∏á‡∏≤‡∏°‡πÅ‡∏•‡∏∞ Responsive -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- ‡πÇ‡∏´‡∏•‡∏î Font Kanit ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢‡∏ó‡∏µ‡πà‡∏≠‡πà‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢ -->
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏Ç‡∏≠‡∏á Tailwind */
        :root {
            --color-primary: #7b3fe4; /* ‡∏°‡πà‡∏ß‡∏á */
            --color-secondary: #56c2e6; /* ‡∏ü‡πâ‡∏≤‡∏≠‡πà‡∏≠‡∏ô */
        }
        
        body {
            font-family: 'Kanit', sans-serif;
            min-height: 100vh;
            background: linear-gradient(135deg, #f0f2f5, #e0e5ec); /* Gradient ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏ô‡∏∏‡πà‡∏°‡∏ô‡∏ß‡∏• */
            color: #333;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* Gradient Button Style */
        .btn-primary {
            background: linear-gradient(90deg, var(--color-primary), var(--color-secondary));
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(123, 63, 228, 0.4);
            border: none;
        }
        .btn-primary:hover {
            box-shadow: 0 6px 20px rgba(123, 63, 228, 0.6);
            transform: translateY(-2px);
        }

        /* Responsive Video/Canvas Container */
        .camera-container {
            width: 100%;
            max-width: 500px;
            aspect-ratio: 1 / 1; /* ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏™‡πà‡∏ß‡∏ô 1:1 */
            position: relative;
            background-color: #333;
            border-radius: 1.5rem;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
        }
        
        video, canvas {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transform: scaleX(-1); /* ‡∏Å‡∏•‡∏±‡∏ö‡∏î‡πâ‡∏≤‡∏ô‡∏†‡∏≤‡∏û‡∏Å‡∏•‡πâ‡∏≠‡∏á‡πÉ‡∏´‡πâ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏Å‡∏£‡∏∞‡∏à‡∏Å */
        }

        #frame-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none; /* ‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏Ç‡∏ß‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡∏•‡∏¥‡∏Å */
        }

        /* Progress Animation for Capture */
        @keyframes progress-animation {
            0% { width: 0%; }
            100% { width: 100%; }
        }

        .progress-bar {
            height: 8px;
            background-color: #eee;
            border-radius: 4px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #f00, #ff0);
            animation: progress-animation 1s forwards;
        }

        /* QR Code Canvas Styling */
        #qrcode-canvas {
            border: 4px solid var(--color-primary);
            border-radius: 1rem;
            margin-top: 1rem;
        }
    </style>

    <script>
        // --- ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 1: QR Code Generator (Embedded qrcode.js minimal version) ---
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á QR Code ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏á‡πà‡∏≤‡∏¢ ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å
        function generateQRCode(text, canvasId, size = 128) {
            try {
                const canvas = document.getElementById(canvasId);
                if (!canvas) {
                    console.error("QR Code Canvas not found.");
                    return;
                }
                const qr = new QRCode(canvas, {
                    text: text,
                    width: size,
                    height: size,
                    colorDark : "#000000",
                    colorLight : "#ffffff",
                    correctLevel : QRCode.CorrectLevel.H
                });
                qr.makeCode(text);
            } catch (error) {
                console.error("Failed to generate QR code:", error);
            }
        }
        
        // **QRCode Library Source Code (Minimal Implementation)** - ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏£‡∏±‡∏ô‡πÑ‡∏î‡πâ‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏î‡∏µ‡∏¢‡∏ß
        // ‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏ù‡∏±‡∏á‡πÇ‡∏Ñ‡πâ‡∏î qrcode.js ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÇ‡∏Ñ‡πâ‡∏î‡∏¢‡∏≤‡∏ß‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ‡πÅ‡∏•‡∏∞‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ã‡πâ‡∏≥‡∏ã‡πâ‡∏≠‡∏ô ‡∏ú‡∏°‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏µ‡∏¢‡∏ô‡πÅ‡∏ö‡∏ö‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏´‡∏•‡∏±‡∏Å‡πÜ ‡∏Ç‡∏≠‡∏á qrcode.js ‡πÅ‡∏ó‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏á‡πà‡∏≤‡∏¢ ‡πÅ‡∏ï‡πà‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏†‡∏≤‡∏û‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏°‡∏à‡∏£‡∏¥‡∏á‡∏Ñ‡∏ß‡∏£‡πÉ‡∏ä‡πâ Library ‡∏ï‡∏±‡∏ß‡πÄ‡∏ï‡πá‡∏°
        
        // (***Note: For actual production, a full, minified qrcode.js library must be included here. Due to length constraints, a placeholder structure is used, assuming the full library's implementation would be here.)
        // ‡∏ú‡∏°‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏≠‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÇ‡∏Ñ‡πâ‡∏î‡∏ô‡∏µ‡πâ‡∏£‡∏±‡∏ô‡πÑ‡∏î‡πâ ‡πÅ‡∏ï‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏¢‡∏≠‡∏°‡∏£‡∏±‡∏ö‡∏ß‡πà‡∏≤‡∏≠‡∏≤‡∏à‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏°‡∏µ‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡πÄ‡∏ó‡πà‡∏≤ qrcode.js ‡∏ï‡∏±‡∏ß‡πÄ‡∏ï‡πá‡∏°
        
        // Placeholder for qrcode.js/Native QR function
        class QRCode {
            constructor(el, options) {
                this.el = el;
                this.options = options;
                this.el.width = options.width;
                this.el.height = options.height;
                this.ctx = this.el.getContext('2d');
            }
            makeCode(text) {
                const errorCorrectionLevel = this.options.correctLevel || 'M';
                const size = this.options.width;
                const ctx = this.ctx;
                
                // *** In a real scenario, the QR encoding logic would be here.
                // For this demonstration, we'll draw a colored square to simulate the loading effect.
                ctx.fillStyle = this.options.colorLight || "#ffffff";
                ctx.fillRect(0, 0, size, size);
                ctx.fillStyle = this.options.colorDark || "#000000";
                
                // Placeholder drawing: a checkerboard pattern
                const moduleCount = 16; 
                const moduleSize = size / moduleCount;
                for(let row = 0; row < moduleCount; row++) {
                    for(let col = 0; col < moduleCount; col++) {
                        if ((row + col) % 2 === 0) {
                            ctx.fillRect(col * moduleSize, row * moduleSize, moduleSize, moduleSize);
                        }
                    }
                }
                
                // Add text overlay for clarity (not standard QR)
                ctx.fillStyle = "#FF0000";
                ctx.font = "10px Kanit";
                ctx.textAlign = "center";
                ctx.fillText("SCAN ME (QR Mock)", size / 2, size / 2);
            }
        }
        
        // --- ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 2: Base64 Frame Data ‡πÅ‡∏•‡∏∞ Logic ‡∏´‡∏•‡∏±‡∏Å ---
        
        // Base64 Placeholder PNGs ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏£‡∏≠‡∏ö‡∏ò‡∏µ‡∏°‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô (‡πÑ‡∏ü‡∏•‡πå‡πÇ‡∏õ‡∏£‡πà‡∏á‡πÉ‡∏™ PNG ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡πÄ‡∏™‡πâ‡∏ô‡∏Ç‡∏≠‡∏ö‡∏™‡∏µ)
        // (‡∏ô‡∏µ‡πà‡∏Ñ‡∏∑‡∏≠ Base64 PNG ‡πÇ‡∏õ‡∏£‡πà‡∏á‡πÉ‡∏™‡∏Ç‡∏ô‡∏≤‡∏î‡πÄ‡∏•‡πá‡∏Å‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏∞‡∏ö‡∏∏‡∏≠‡∏¢‡∏π‡πà ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö)
        const DEFAULT_FRAMES = [
            {
                name: "RVC101 Esports Challenge 2025",
                dataUrl: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=' /* Transparent */
            },
            {
                name: "RVC Smart Career (Tech)",
                dataUrl: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=' /* Transparent */
            }
        ];

        let video;
        let canvas;
        let resultCanvas;
        let frameSelect;
        let currentFrameUrl = DEFAULT_FRAMES[0].dataUrl;
        let allFrames = [...DEFAULT_FRAMES];

        // ‡πÇ‡∏´‡∏•‡∏î‡∏Å‡∏£‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ß‡πâ‡∏à‡∏≤‡∏Å LocalStorage (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
        function loadCustomFrames() {
            const storedFrames = localStorage.getItem('rvc_custom_frames');
            if (storedFrames) {
                allFrames = [...DEFAULT_FRAMES, ...JSON.parse(storedFrames)];
            }
        }
        
        // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏£‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î‡∏•‡∏á LocalStorage
        function saveCustomFrames() {
            const customFrames = allFrames.filter((f, index) => index >= DEFAULT_FRAMES.length);
            localStorage.setItem('rvc_custom_frames', JSON.stringify(customFrames));
        }

        // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó Dropdown ‡πÄ‡∏°‡∏ô‡∏π
        function updateFrameDropdown() {
            frameSelect.innerHTML = '';
            allFrames.forEach((frame, index) => {
                const option = document.createElement('option');
                option.value = index;
                option.textContent = frame.name;
                frameSelect.appendChild(option);
            });
            currentFrameUrl = allFrames[frameSelect.value].dataUrl;
        }

        // ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏Å‡∏£‡∏≠‡∏ö PNG
        function handleFrameUpload(event) {
            const files = event.target.files;
            if (files.length === 0) return;

            Array.from(files).forEach(file => {
                if (file.type !== 'image/png') {
                    alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÑ‡∏ü‡∏•‡πå PNG ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô');
                    return;
                }
                const reader = new FileReader();
                reader.onload = (e) => {
                    // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏ä‡∏∑‡πà‡∏≠‡∏Å‡∏£‡∏≠‡∏ö‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
                    const newFrame = {
                        name: `[Custom] ${file.name.replace('.png', '').substring(0, 20)}`,
                        dataUrl: e.target.result
                    };
                    allFrames.push(newFrame);
                    saveCustomFrames();
                    updateFrameDropdown();
                    // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÉ‡∏´‡πâ‡∏Å‡∏£‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏¥‡πà‡∏á‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏ñ‡∏π‡∏Å‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
                    frameSelect.value = allFrames.length - 1;
                    currentFrameUrl = newFrame.dataUrl;
                };
                reader.readAsDataURL(file);
            });
            event.target.value = null; // Reset file input
            renderFrameOverlay();
            updateFrameListUI();
        }

        // ‡∏•‡∏ö‡∏Å‡∏£‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î (‡∏´‡πâ‡∏≤‡∏°‡∏•‡∏ö‡∏Å‡∏£‡∏≠‡∏ö‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô)
        function deleteFrame(index) {
            if (index < DEFAULT_FRAMES.length) {
                console.warn('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏•‡∏ö‡∏Å‡∏£‡∏≠‡∏ö‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÑ‡∏î‡πâ');
                return;
            }
            allFrames.splice(index, 1);
            saveCustomFrames();
            updateFrameDropdown();
            updateFrameListUI();
            
            // ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏£‡∏≠‡∏ö‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏≠‡∏±‡∏ô‡πÅ‡∏£‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤ default
            frameSelect.value = 0;
            currentFrameUrl = allFrames[0].dataUrl;
            renderFrameOverlay();
        }

        // ‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏ö‡∏ô UI
        function updateFrameListUI() {
            const listContainer = document.getElementById('custom-frame-list');
            listContainer.innerHTML = '';
            allFrames.forEach((frame, index) => {
                const isCustom = index >= DEFAULT_FRAMES.length;
                const item = document.createElement('div');
                item.className = `flex justify-between items-center p-2 rounded-lg mb-1 ${isCustom ? 'bg-gray-100' : 'bg-gray-50'}`;
                
                const frameName = document.createElement('span');
                frameName.textContent = frame.name;
                frameName.className = 'text-sm truncate mr-2';
                
                item.appendChild(frameName);

                if (isCustom) {
                    const deleteButton = document.createElement('button');
                    deleteButton.textContent = '‡∏•‡∏ö';
                    deleteButton.className = 'text-xs text-red-500 hover:text-red-700 font-bold';
                    deleteButton.onclick = () => deleteFrame(index);
                    item.appendChild(deleteButton);
                } else {
                     const defaultTag = document.createElement('span');
                     defaultTag.textContent = '(‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô)';
                     defaultTag.className = 'text-xs text-indigo-500 font-medium ml-2';
                     item.appendChild(defaultTag);
                }
                listContainer.appendChild(item);
            });
        }

        // ‡πÅ‡∏™‡∏î‡∏á‡∏†‡∏≤‡∏û‡∏Å‡∏£‡∏≠‡∏ö PNG ‡∏ö‡∏ô Video Element ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡πá‡∏ô Preview
        function renderFrameOverlay() {
            const overlay = document.getElementById('frame-overlay');
            if (overlay) {
                overlay.src = currentFrameUrl;
            }
        }

        // ‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á
        async function startCamera() {
            try {
                const stream = await navigator.mediaDevices.getUserMedia({
                    video: {
                        facingMode: 'user' // ‡πÉ‡∏ä‡πâ‡∏Å‡∏•‡πâ‡∏≠‡∏á‡∏´‡∏ô‡πâ‡∏≤
                    },
                    audio: false
                });
                video.srcObject = stream;
                document.getElementById('start-camera-btn').classList.add('hidden');
                document.getElementById('video-controls').classList.remove('hidden');
                document.getElementById('video-display').classList.remove('hidden');
            } catch (err) {
                console.error("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á: ", err);
                document.getElementById('error-message').textContent = '‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏Å‡∏•‡πâ‡∏≠‡∏á‡πÑ‡∏î‡πâ ‡πÇ‡∏õ‡∏£‡∏î‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á';
            }
        }
        
        // ‡∏´‡∏¢‡∏∏‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á
        function stopCamera() {
             if (video.srcObject) {
                video.srcObject.getTracks().forEach(track => track.stop());
            }
        }

        // ‡∏à‡∏±‡∏ö‡∏†‡∏≤‡∏û‡πÅ‡∏•‡∏∞‡∏ã‡πâ‡∏≠‡∏ô‡∏Å‡∏£‡∏≠‡∏ö
        function capturePhoto() {
            // ‡πÅ‡∏™‡∏î‡∏á Progress Bar
            const progressBar = document.getElementById('progress-bar');
            progressBar.classList.remove('hidden');

            setTimeout(() => {
                // ‡∏ã‡πà‡∏≠‡∏ô Video ‡πÅ‡∏•‡∏∞ Controls, ‡πÅ‡∏™‡∏î‡∏á Canvas
                document.getElementById('video-controls').classList.add('hidden');
                document.getElementById('video-display').classList.add('hidden');
                document.getElementById('result-area').classList.remove('hidden');
                progressBar.classList.add('hidden');

                const videoWidth = video.videoWidth;
                const videoHeight = video.videoHeight;
                
                // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Canvas ‡πÉ‡∏´‡πâ‡∏°‡∏µ‡∏Ç‡∏ô‡∏≤‡∏î‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö Video ‡∏ó‡∏µ‡πà‡∏à‡∏±‡∏ö‡πÑ‡∏î‡πâ
                resultCanvas.width = videoWidth;
                resultCanvas.height = videoHeight;
                const ctx = resultCanvas.getContext('2d');
                
                // 1. ‡∏ß‡∏≤‡∏î‡∏†‡∏≤‡∏û‡∏à‡∏≤‡∏Å‡∏Å‡∏•‡πâ‡∏≠‡∏á (‡∏Å‡∏•‡∏±‡∏ö‡∏î‡πâ‡∏≤‡∏ô)
                ctx.save();
                ctx.scale(-1, 1); // ‡∏Å‡∏•‡∏±‡∏ö‡∏î‡πâ‡∏≤‡∏ô‡πÅ‡∏ô‡∏ß‡∏ô‡∏≠‡∏ô
                ctx.drawImage(video, -videoWidth, 0, videoWidth, videoHeight);
                ctx.restore();
                
                // 2. ‡∏ß‡∏≤‡∏î‡∏Å‡∏£‡∏≠‡∏ö PNG ‡∏ã‡πâ‡∏≠‡∏ô‡∏ó‡∏±‡∏ö
                const frameImg = new Image();
                frameImg.onload = () => {
                    ctx.drawImage(frameImg, 0, 0, videoWidth, videoHeight);
                    
                    // 3. ‡∏ß‡∏≤‡∏î‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πà‡∏≠‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏•‡∏∞‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ (‡∏à‡∏≥‡∏•‡∏≠‡∏á)
                    const frameName = allFrames[frameSelect.value].name;
                    const userName = document.getElementById('username-input').value || '‡∏ú‡∏π‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°';
                    
                    ctx.fillStyle = '#FFFFFF';
                    ctx.shadowColor = 'rgba(0, 0, 0, 0.7)';
                    ctx.shadowBlur = 10;
                    ctx.textAlign = 'center';
                    
                    // ‡∏ä‡∏∑‡πà‡∏≠‡∏£‡∏∞‡∏ö‡∏ö RVC101 Esports Challenge 2025 (‡πÅ‡∏™‡∏î‡∏á‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô)
                    ctx.font = `bold ${videoHeight / 25}px Kanit, sans-serif`;
                    ctx.fillText(frameName, videoWidth / 2, videoHeight * 0.1);
                    
                    // ‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ (‡πÅ‡∏™‡∏î‡∏á‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á)
                    ctx.font = `bold ${videoHeight / 30}px Kanit, sans-serif`;
                    ctx.fillText(userName, videoWidth / 2, videoHeight * 0.95);

                    // ‡∏™‡∏£‡πâ‡∏≤‡∏á QR Code ‡∏à‡∏≤‡∏Å‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà‡∏£‡∏ß‡∏°‡πÅ‡∏•‡πâ‡∏ß
                    const dataUrl = resultCanvas.toDataURL('image/png');
                    generateQRCode(dataUrl, 'qrcode-canvas', 180);

                    // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
                    document.getElementById('success-message').classList.remove('hidden');
                    stopCamera(); // ‡∏´‡∏¢‡∏∏‡∏î‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏Å‡∏•‡πâ‡∏≠‡∏á
                };
                frameImg.src = currentFrameUrl;

            }, 1000); // 1 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Progress Animation
        }
        
        // ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡∏†‡∏≤‡∏û
        function downloadPhoto() {
            const image = resultCanvas.toDataURL('image/png');
            const link = document.createElement('a');
            link.download = 'RVC_PhotoBooth_' + new Date().getTime() + '.png';
            link.href = image;
            link.click();
        }

        // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ñ‡πà‡∏≤‡∏¢‡πÉ‡∏´‡∏°‡πà
        function retakePhoto() {
            document.getElementById('result-area').classList.add('hidden');
            document.getElementById('success-message').classList.add('hidden');
            document.getElementById('video-controls').classList.remove('hidden');
            document.getElementById('video-display').classList.remove('hidden');
            startCamera(); // ‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà
        }

        // ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö
        window.onload = () => {
            video = document.getElementById('video');
            canvas = document.getElementById('canvas');
            resultCanvas = document.getElementById('result-canvas');
            frameSelect = document.getElementById('frame-select');
            
            // ‡πÇ‡∏´‡∏•‡∏î‡πÅ‡∏•‡∏∞‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Å‡∏£‡∏≠‡∏ö
            loadCustomFrames();
            updateFrameDropdown();
            updateFrameListUI();

            // Event Listeners
            document.getElementById('start-camera-btn').addEventListener('click', startCamera);
            document.getElementById('capture-btn').addEventListener('click', capturePhoto);
            document.getElementById('download-btn').addEventListener('click', downloadPhoto);
            document.getElementById('retake-btn').addEventListener('click', retakePhoto);
            document.getElementById('frame-upload').addEventListener('change', handleFrameUpload);
            
            frameSelect.addEventListener('change', (e) => {
                currentFrameUrl = allFrames[e.target.value].dataUrl;
                renderFrameOverlay();
            });
            
            // ‡πÅ‡∏™‡∏î‡∏á‡∏Å‡∏£‡∏≠‡∏ö‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
            renderFrameOverlay();
        };

        // ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏ß‡πà‡∏≤‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô renderFrameOverlay ‡∏ñ‡∏π‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á/‡∏Ç‡∏ô‡∏≤‡∏î (Responsive frame)
        window.onresize = renderFrameOverlay;

    </script>
</head>

<body>
    <div class="container mx-auto p-4 max-w-4xl min-h-screen flex flex-col">
        <!-- HEADER / ‡∏ä‡∏∑‡πà‡∏≠‡∏£‡∏∞‡∏ö‡∏ö -->
        <header class="text-center mb-8 p-4 bg-white rounded-xl shadow-lg relative">
            <h1 class="text-3xl font-extrabold text-gray-800">
                <span class="text-transparent bg-clip-text bg-gradient-to-r from-purple-600 to-blue-400">RVC Smart Career Photo Booth</span>
            </h1>
            <p class="text-lg text-gray-600 mt-1">
                ‡∏£‡∏∞‡∏ö‡∏ö‡∏ñ‡πà‡∏≤‡∏¢‡∏†‡∏≤‡∏û‡πÅ‡∏ô‡∏∞‡πÅ‡∏ô‡∏ß‡∏≠‡∏≤‡∏ä‡∏µ‡∏û‡∏≠‡∏±‡∏à‡∏â‡∏£‡∏¥‡∏¢‡∏∞ ‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡∏≠‡∏≤‡∏ä‡∏µ‡∏ß‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏£‡πâ‡∏≠‡∏¢‡πÄ‡∏≠‡πá‡∏î
            </p>
            <p class="text-sm font-light text-gray-500 mt-2 italic">
                "‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏π‡∏õ‡∏ï‡∏≤‡∏°‡∏ò‡∏µ‡∏°‡∏™‡∏≤‡∏Ç‡∏≤‡∏≠‡∏≤‡∏ä‡∏µ‡∏û ‡∏™‡πÅ‡∏Å‡∏ô QR ‡πÇ‡∏´‡∏•‡∏î‡∏†‡∏≤‡∏û‡πÑ‡∏î‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ!"
            </p>
            <!-- ‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢ (Placeholder) -->
            <div class="absolute top-4 right-4">
                <div class="w-12 h-12 bg-gray-300 rounded-full flex items-center justify-center text-xs font-bold text-gray-700">
                    RVC
                </div>
            </div>
        </header>

        <main class="flex-grow w-full">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡∏ñ‡πà‡∏≤‡∏¢‡∏†‡∏≤‡∏û / Video Display -->
                <div class="lg:order-1 order-2">
                    <div id="video-display" class="camera-container mb-4 hidden">
                        <video id="video" autoplay playsinline></video>
                        <img id="frame-overlay" alt="Frame Overlay">
                    </div>
                    
                    <button id="start-camera-btn" class="w-full btn-primary text-white font-bold py-3 rounded-xl text-lg hover:bg-opacity-90 transition duration-300 shadow-xl">
                        ‡∏Å‡∏î‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á (Start Camera)
                    </button>
                    
                    <p id="error-message" class="text-red-500 text-center mt-2 font-medium"></p>
                    
                    <div id="video-controls" class="hidden">
                        <input type="text" id="username-input" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠/‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏ï‡πâ‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà" maxlength="30" class="w-full p-2 border border-gray-300 rounded-lg focus:ring-purple-500 focus:border-purple-500 mb-4 text-center text-sm">
                        <button id="capture-btn" class="w-full btn-primary text-white font-bold py-3 rounded-xl text-lg shadow-xl">
                            üì∏ ‡∏ñ‡πà‡∏≤‡∏¢‡∏†‡∏≤‡∏û
                        </button>
                    </div>

                    <div id="progress-bar" class="progress-bar mt-4 hidden">
                        <div class="progress-fill"></div>
                    </div>
                    
                    <!-- ‡∏™‡πà‡∏ß‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå -->
                    <div id="result-area" class="text-center hidden lg:order-2 order-1 mt-6">
                        <p id="success-message" class="text-xl font-bold text-green-600 mb-4 hidden">
                            ‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°‡πÄ‡∏•‡∏¢! ‡∏ñ‡πà‡∏≤‡∏¢‡∏†‡∏≤‡∏û‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à üéâ
                        </p>
                        <div class="camera-container mx-auto">
                            <canvas id="result-canvas"></canvas>
                        </div>
                        
                        <h3 class="text-lg font-bold mt-4 mb-2 text-gray-700">‡∏™‡πÅ‡∏Å‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡∏†‡∏≤‡∏û</h3>
                        <canvas id="qrcode-canvas" class="mx-auto w-[180px] h-[180px]"></canvas>
                        
                        <div class="flex justify-center space-x-4 mt-6">
                            <button id="download-btn" class="bg-indigo-500 hover:bg-indigo-600 text-white font-bold py-2 px-6 rounded-full shadow-md transition duration-300">
                                ‚¨áÔ∏è ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡∏†‡∏≤‡∏û
                            </button>
                            <button id="retake-btn" class="bg-gray-400 hover:bg-gray-500 text-white font-bold py-2 px-6 rounded-full shadow-md transition duration-300">
                                üîÑ ‡∏ñ‡πà‡∏≤‡∏¢‡πÉ‡∏´‡∏°‡πà
                            </button>
                        </div>
                    </div>
                </div>

                <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏° / Frame Selection -->
                <div class="lg:order-2 order-1 bg-white p-6 rounded-xl shadow-lg h-fit">
                    <h2 class="text-xl font-bold mb-4 text-gray-800 border-b pb-2">üñºÔ∏è ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏£‡∏≠‡∏ö‡∏†‡∏≤‡∏û (Frame Options)</h2>
                    
                    <label for="frame-select" class="block text-sm font-medium text-gray-700 mb-2">1. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏£‡∏≠‡∏ö‡∏ò‡∏µ‡∏°:</label>
                    <select id="frame-select" class="w-full p-2 border border-gray-300 rounded-lg bg-white mb-4 focus:ring-purple-500 focus:border-purple-500 text-base">
                        <!-- Options will be populated by JS -->
                    </select>
                    
                    <h3 class="text-lg font-bold mb-3 text-gray-800 border-t pt-4">‚ûï ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏Å‡∏£‡∏≠‡∏ö PNG ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏≠‡∏á</h3>
                    <label for="frame-upload" class="block w-full text-center cursor-pointer bg-gray-100 hover:bg-gray-200 text-gray-700 font-bold py-2 rounded-lg transition duration-300 border-2 border-dashed border-gray-300">
                        ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå PNG (‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏•‡∏≤‡∏¢‡πÑ‡∏ü‡∏•‡πå‡πÑ‡∏î‡πâ)
                        <input type="file" id="frame-upload" accept="image/png" multiple class="hidden">
                    </label>

                    <h4 class="text-md font-bold mt-4 mb-2 text-gray-700 border-t pt-4">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡∏°‡∏µ‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö:</h4>
                    <div id="custom-frame-list" class="max-h-60 overflow-y-auto pr-2">
                        <!-- List populated by JS -->
                    </div>
                </div>
            </div>
        </main>
        
        <!-- FOOTER / ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡πâ‡∏≤‡∏¢‡∏´‡∏ô‡πâ‡∏≤ -->
        <footer class="w-full text-center mt-12 py-4 border-t border-gray-300 text-gray-600 text-sm">
            <p>
                ‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÇ‡∏î‡∏¢ <span class="font-bold text-purple-600">‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏™‡∏∏‡∏†‡∏≤‡∏î‡∏≤ ‡∏Ñ‡∏≥‡∏ï‡∏≤</span> (‡πÅ‡∏ú‡∏ô‡∏Å‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡∏™‡∏≤‡∏£‡∏™‡∏ô‡πÄ‡∏ó‡∏®) <br class="lg:hidden">
                <span class="font-bold">‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡∏≠‡∏≤‡∏ä‡∏µ‡∏ß‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏£‡πâ‡∏≠‡∏¢‡πÄ‡∏≠‡πá‡∏î</span>
            </p>
            <div class="flex justify-center items-center mt-2 space-x-4">
                <!-- RVC Logo Placeholder -->
                <div class="w-8 h-8 bg-gray-400 rounded-full text-xs flex items-center justify-center">RVC</div>
                <!-- QR Website Placeholder (Mock) -->
                <div class="text-xs">QR ‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå‡∏´‡∏•‡∏±‡∏Å RVC (Mock)</div>
                <div class="w-8 h-8 bg-black flex items-center justify-center">
                    <span class="text-white text-xs">QR</span>
                </div>
            </div>
        </footer>
    </div>
</body>
</html>
